<div class="container">
  <!--Header-->
  <header align="center">
    <div name="title">
      <h1>CORTS - CACC Operational <br> Reports Tracking System</h1>
      <h3>454 - MIS CACC</h3>
    </div>
    <div name="nav">
      <button class = "navBtn" routerLink="/mainpage">Start Page</button>
      <button class = "navBtn" routerLink="/query">Search</button>
      <button class = "navBtn" routerLink="/logout">Logout</button>
    </div>
  </header>
</div>

<form id="IncidentReport">
  <div class="container">
    <h2>Incident Report</h2>
    <hr>

    <!-- Basic Information -->
    <h4>Basic Information:</h4>

    <div class="grid-container">
        <div class="grid-item">
          <label>Created</label>
          <input type="text" [value]="fullDateTime" disabled />
        </div>
        <div class="grid-item">
          <label>COR #</label>
          <input type="text" [value]="corNumber" disabled />
        </div>
        <div class="grid-item">
          <label>Due Date</label>
          <input type="text" [value]="dueDate" disabled />
        </div>
        <div class="grid-item">
          <label>Status</label>
          <input type="text" [value]="status" disabled />
        </div>
        <div class="grid-item">
          <label>COR Type</label>
          <input type="text" value="Incident" disabled />
        </div>
        <div class="grid-item"> <!-- how do I fetch the current user information?--> 
          <label>Creator</label>
          <input type="text" [value]="incidentData.creator" disabled />
        </div>
        <div class="grid-item">
          <label>Route To</label> <!-- how do I fetch the current user information?-->
          <select>
            <option selected>29030, CASSONDRA FOERTER - COM</option>
            <option>Supervisor Group</option>
          </select>
        </div>
        <div class="grid-item">
          <label>Incident (Call) #</label>
          <input type="text" />
          <button>View in VisiCAD</button>
        </div>
        <div class="grid-item">
          <label>Related CORs</label>
          <input type="text" [(ngModel)]="relatedCORsInput" name="relatedCORsInput"/> <!--enter related COR number-->
          <select size="5" [(ngModel)]="selectedRelatedCOR" name="selectedRelatedCOR">
            <option *ngFor="let cor of relatedCORs" [value]="cor">{{ cor }}</option>
          </select>
          <div class="button-group">
            <button class="btn primary" (click)="addRelatedCOR($event)" type="button">Add Related COR</button>
            <button class="btn warn" (click)="removeSelectedCOR($event)" type="button">Remove Related COR</button>
          </div>
        </div>
    </div>
  </div>

  <div class="container">
    <!-- Incident Report -->
    <h4>Incident Report:</h4>
    <hr>
    <div class="grid-container">

      <!-- Incident Type -->
      <div class="grid-item">
        <label class="req-input">Incident Type*</label>
        <select [(ngModel)] = "incidentType">
          <option selected value = "1">Delay in Response</option>
          <option value = "2">MCI</option>
          <option value = "3">Other</option>
          <option value = "4">Unusual Occurance</option>
        </select>
      </div>

      <!-- Date/Time of Incident -->
      <div class="grid-item">
        <label class="req-input" for="pronouncedDateTime">Date/Time of Incident*</label>
        <input type="datetime-local" id="pronouncedDateTime" />
      </div>
    </div>
    <div class="grid-item">
      <label class="req-input">Incident Details:*</label>
      <textarea rows="5" maxlength="255" [(ngModel)]="incidentCommentText" name="incidentCommentText"></textarea>
    </div>
  </div>

  <div class="container">

    <!-- Narrative -->
    <h4>Narrative:</h4>
    <hr>

    <!-- Narative Table -->
    <table width="100%">
      <thead>
        <tr>
          <th width = 10%>Date</th>
          <th width = 13%>Time</th>
          <th width = 10%>User</th>
          <th>Comments</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let entry of combinedEntries">
          <td>{{ entry.date }}</td>
          <td>{{ entry.time }}</td>
          <td>{{ entry.user }}</td>
          <td [ngClass]="{'incident-comment': entry.type === 'incident', 'narrative-comment': entry.type === 'narrative'}" name="incidentComment">
            {{ entry.comment }}
          </td>
        </tr>
      </tbody>
    </table>

    <div class="grid-item">
      <label>Comments:</label>
      <textarea rows="5" maxlength="255" [(ngModel)]="narrativeCommentText" name="narrativeCommentText"></textarea>
    </div>

    <!-- Action Buttons -->
    <div class="form-actions">
      <button class="btn primary" (click)="saveChanges()">Save Changes</button>
      <button class="btn primary"> Save Changes and Exit</button>
      <button class="btn warn">Reload Page</button>
    </div>
  </div>
</form>

