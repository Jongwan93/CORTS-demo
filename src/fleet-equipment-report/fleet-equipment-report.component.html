<!-- Code for the Fleet Equipment Failure & Vehicle Breakdown Report Page -->

<!-- Header -->
<app-header></app-header>

<!----------------------------------------------------------------->

<form
  id="frmCOR"
  method="post"
  action="COR.ASP?WCI=tpl_cor&amp;WCE=Submit&amp;WCU="
  target="_top"
>
  <!-- Basic Information -->
  <app-basic-information
    [corNumber]="corNumber"
    [routedToSelection]="routedToSelection"
    (routedToSelectionChangeDetect)="updateRoutedToSelection($event)"
    (statusIDChange)="updateStatusID($event)"
  >
  </app-basic-information>
  <!-- End of Basic Information (White Card) -->

  <!----------------------------------------------------------------->

  <!-- Breakdown Details -->
  <div class="container">
    <h4>Breakdown Details:</h4>
    <hr />

    <!-- Breakdown Details Content -->
    <div class="grid-container">
      <!-- Breakdown Type* -->
      <div class="grid-item">
        <label class="req-input">Breakdown Type*</label>
        <select
          id="VehicleFailure_BreakDownType_FK"
          [(ngModel)]="breakDownTypeKey"
          name="breakDownType"
          (change)="breakDownTypeChange(breakDownTypeKey)"
          appDisableIf
          required
        >
          <option value="">-- Select a Breakdown Type --</option>
          <option
            *ngFor="let type of breakDownTypeList"
            [value]="type.breakDownTypeKey"
          >
            {{ type.displayName }}
          </option>
        </select>
        <textarea
          rows="5"
          [(ngModel)]="breakDownCommentText"
          name="breakDownCommentText"
          appDisableIf
        ></textarea>
      </div>

      <!-- Date/Time of Failure* -->
      <div class="grid-item">
        <label class="req-input">Date/Time of Failure*</label>
        <input
          type="datetime-local"
          id="VehicleFailure_FailureDate_Date"
          [(ngModel)]="failureDateTime"
          name="failureDateTime"
          appDisableIf
          required
        />
      </div>

      <!-- Service/Station* -->
      <div class="grid-item">
        <label class="req-input">Service/Station*</label>
        <input
          type="text"
          id="VehicleFailure_ServiceInfo"
          [(ngModel)]="serviceStation"
          name="serviceStation"
          maxlength="5"
          appDisableIf
          required
        />
      </div>

      <!-- Failure Details or Other Info* -->
      <div class="grid-item">
        <label class="req-input">Failure Details or Other Info*</label>
        <textarea
          id="VehicleFailure_Description"
          rows="5"
          [(ngModel)]="failureCommentText"
          name="failureCommentText"
          appDisableIf
          required
        ></textarea>
      </div>

      <!-- Unit ID -->
      <div class="grid-item">
        <label>Unit ID</label>
        <input
          type="text"
          id="VehicleFailure_VehicleNum"
          [(ngModel)]="unitID"
          name="unitID"
          maxlength="5"
          appDisableIf
          required
        />
      </div>

      <!-- Container for Checkbox Fields. Wraps Fields as screen size changes -->
      <div class="grid-flow">
        <!-- Response Delay -->
        <div class="grid-item">
          <label for="pronouncedDateTime">Response Delay:</label>
          <div class="time-duration-container">
            <input
              type="checkbox"
              id="delay"
              (change)="toggleDelayTime()"
              appDisableIf
            />
            <!-- Hours -->
            <input
              type="number"
              id="delay-hours"
              min="0"
              max="99"
              step="1"
              [(ngModel)]="delayHours"
              (ngModelChange)="updateResponseDelay()"
              [disabled]="!isDelaySelected"
              name="delayHours"
              appDisableIf
            />
            <p>:</p>
            <input
              type="number"
              id="delay-minutes"
              min="0"
              max="59"
              step="1"
              [(ngModel)]="delayMinutes"
              (ngModelChange)="updateResponseDelay()"
              [disabled]="!isDelaySelected"
              name="delayHours"
              appDisableIf
            />
          </div>
        </div>

        <!-- Patient on Board -->
        <div class="grid-item">
          <label>Patient on Board:</label>
          <input
            type="checkbox"
            id="VehicleFailure_PatientOnBoard"
            [(ngModel)]="isPatientOnBoard"
            name="isPatientOnBoard"
            appDisableIf
          />
        </div>
      </div>
      <!-- End of container-flow -->
    </div>
    <!-- End of Breakdown Details Content-->
  </div>
  <!-- End of Breakdown Details (White Card) -->

  <!----------------------------------------------------------------->

  <!-- Narrative -->
  <div class="container">
    <h4>Narrative:</h4>
    <hr />

    <app-narrative
      [combinedEntries]="combinedEntries"
      [(narrativeCommentText)]="narrativeCommentText"
      (saveChanges)="saveChanges()"
      (saveChangesExit)="saveChangesExit()"
      (reload)="reload()"
    ></app-narrative>
  </div>
  <!-- End of Narrative (White Card)-->
</form>
